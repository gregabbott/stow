<!-- Merged 2025_05_15 -->
<html lang="en"><head><meta charset="UTF-8"><meta name="color-scheme" content="light dark"><link rel="icon" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbDpzcGFjZT0icHJlc2VydmUiICB4PSIwIiB5PSIwIiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCAyMDAgMjAwIj4KICA8c3R5bGU+LmF7CmZpbGw6IzI1MjUyNTsKZm9udC1mYW1pbHk6VmVyZGFuYTsKdGV4dC1hbmNob3I6bWlkZGxlOwp9PC9zdHlsZT4KICA8cmVjdCB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI0ZGRiIvPjx0ZXh0IGNsYXNzPSJhIiBmb250LXNpemU9IjY4cHgiIHg9IjEwMCIgeT0iMTE2Ljg3NSI+U3RvdzwvdGV4dD48L3N2Zz4="><style>/* frame.css */
:root {color-scheme: light dark;--light: hsl(0, 0%, 100%);--dark: hsl(0, 0%, 0%);--accent: #8e70f7;--bg: light-dark(var(--light), var(--dark));--fg: light-dark(var(--dark), var(--light));--brd: 1px solid var(--fg);--rad: 1lh;--bs0: inset 0 0 0 .5px var(--fg);--bs: inset 0 0 0 1px var(--fg);--bs2: inset 0 0 0 2px var(--fg);accent-color: var(--fg);}* {margin: 0;padding: 0;font-family: monospace;box-sizing: border-box;font-size: 15px;user-select: none;line-height: 100%;outline: none;border: none;}@media (prefers-color-scheme: light) {::-moz-selection {background-color: var(--dark);color:var(--light);}::selection{background-color: var(--dark);color: var(--light);}}@media (prefers-color-scheme: dark) {::-moz-selection{background-color: var(--light);color:var(--dark);}::selection{background-color: var(--light);color:var(--dark);}}a{color: var(--fg);}hr{height: 1lh;}#notice{background-color: var(--fg);color: var(--bg);position: fixed;width: 100%;bottom: 0lh;left: 0ch;padding: .5em 1ch;text-align: left;display: block;}table{border-collapse: collapse;}select {background-color: var(--bg);color: var(--fg);border: var(--brd);padding: 0;font-family: 15px;line-height: 2lh;height: 1lh;padding: 0 1ch;-webkit-appearance: none;-moz-appearance: none;appearance: none;}.faux_po_holder{width: fit-content;height: fit-content;display: block;position: absolute;z-index: 4;}.faux_po_content {box-shadow: var(--bs);outline: var(--brd);outline-offset: -1px;background: var(--bg);overflow: hidden;position: fixed;}#row_actions_po,#column_actions_po{.faux_po_content{margin: -.5px !important;padding: 0;width: 16ch;button {box-shadow: none;width: 100%;text-align: left;&:hover {background: var(--fg);color: var(--bg);}}max-height: calc(100dvh - 2lh);overflow-y: auto;}}#column_type_po .faux_po_content{width: 64ch;padding: 1lh 1ch;select {width: 100%;}}#filter_popover .faux_po_content{top: 1lh;left: 1ch;display: flex;#filter_switch{padding: .5em 1ch;width: 6ch;text-align: right;}gap: 0ch;align-items: center;#filter_query{width:40ch}#filter_name{width: 40ch;}label{height: 2lh !important;min-height: 2lh;position: relative;display: flex;align-items: center;gap: 1ch;width: 100%;box-shadow: var(--bs0);&:active,&:focus-within{b{font-weight: bold;}}b{width: 6ch;text-align: right;font-weight: normal;}padding: 0 1ch;input{padding: 0;box-shadow: none;}}}.faux_po_backdrop {position: fixed;top: 0;left: 0;background: var(--accent);opacity: 0.0;height: 100dvh;width: 100dvw;display: block;}.full_viewport_notice {position: fixed;background-color: var(--bg);color: var(--fg);padding: 2ch;top: 0;left: 0;height: 100dvh;width: 100dvw;z-index: 999;display: flex;flex-direction: column;align-items: center;justify-content: center;text-align: center;}:popover-open,dialog:open {display: flex;flex-direction: column;}[popover],dialog {outline: 2px solid var(--fg);outline-offset: 0px;border: none;left: 3ch;top: 2lh;padding: 2lh 3ch;max-height: calc(100dvh - 4lh);background-color: var(--bg);z-index: 9999;width: 64ch;max-width: calc(100dvw - 2ch);}.disabled {pointer-events: none;opacity: .5;}button,input {margin: 0;border: none;}input {padding: 0 1ch;background-color: transparent;height: 2lh;&[type="search"] {box-shadow: var(--bs);}outline: 0;&:focus {box-shadow: inset 0 0 0 2px var(--fg);}}button,.button {padding: 0 1ch;display: flex;align-items: center;box-shadow: inset 0 0 0 1px var(--fg);height: 2lh;background-color: var(--bg);color: var(--fg);border: none;&:active {background: var(--fg);color: var(--bg);}}html,body {height: 100dvh;max-height: 100dvh;margin: 0;}body {color: var(--fg);background-color: var(--bg);display: flex;flex-direction: column;padding: 1lh 1ch;}main {display: flex;flex-grow: 1;overflow: hidden;}#menu_items {display: flex;flex-direction: column;}.new_column_strip {position: absolute;display: block;height: 100dvh;right: -1px;z-index: 999;width: 2px;background-color: var(--fg);cursor: pointer;}::-webkit-scrollbar {font-family: monospace;width: 1ch;height: 1lh;cursor: pointer;background-color: transparent;}::-webkit-scrollbar-thumb {background: transparent;border-radius: 0;box-shadow: inset 0 0 0 1px var(--fg);border: none;}::-webkit-scrollbar-track,::-webkit-scrollbar-corner {background: transparent;}.grid {background-image:linear-gradient(to right,hsla(0, 0%, 50%, 0.1) 1px,transparent 1px),linear-gradient(to bottom,hsla(0, 0%, 50%, 0.1) 1px,transparent 1px);background-size: 1ch 1lh;background-position: -.5px -.5px;}.grid_dots {background-image:radial-gradient(circle at 0 0, var(--fg) .5px, transparent 0),radial-gradient(circle at 100% 0, var(--fg) .5px, transparent 0),radial-gradient(circle at 0 100%,var(--fg) .5px, transparent 0),radial-gradient(circle at 100% 100%, var(--fg) .5px, transparent 0);background-size: 1ch 1lh;background-position: 0 0, 0 0, 0 0, 0 0;}nav {display: flex;min-height: 2lh;gap: 1ch;margin-bottom: 1lh;.grow {flex-grow: 1;}}g-db {height: 100%;width: 100%;display: flex;flex-direction: column;#table_holder {display: flex;align-items: start;flex-direction: column;flex: 0 1 auto;overflow-x: scroll;overflow-y: scroll;position: relative;width: 100%;height: 100%;background-color: transparent;max-width: 100%;padding: 0 1ch 50dvh 0;table {box-sizing: border-box;margin: 0;padding: 0;flex-grow: 0;width: auto;height: auto;display: table;table-layout: auto;border-collapse: collapse;border-spacing: 0;border: none;position: relative;&::after{content: "";position: absolute;top: .5px;left: .5px;outline-offset: -.5px;display: block;width: calc(100% - .5px);height: calc(100% - .5px);z-index: 3;outline: 1px solid var(--fg);pointer-events: none;}caption {background: var(--bg);outline: 1px dashed var(--fg);outline-offset: -.5px;padding: .5em 1ch;}caption,thead{top: 0;position: sticky;z-index: 3;}th {width: 6ch;min-width: 6ch;max-width: 6ch;text-align: right;font-weight: normal;}th,td {background-color: var(--bg);outline: 1px dashed var(--fg);outline-offset: -.5px;height: 2lh;vertical-align: top;padding:calc(.5em)calc(1ch);line-height:1em;position: relative;min-width: calc(3ch - 1px);max-width: 66ch;}td{&:hover, &.selected {z-index: 1;outline-style: solid;outline-width: 1.5px;}}thead {top:2lh;&::after{width: 100%;height: 1px;position: absolute;z-index: 1;bottom: -0.5px;content: "";left: 0;display: block;background-color: var(--fg);}th,td{background-color: var(--bg);}tr:first-of-type td {cursor: context-menu;}}tbody {background-color: #8e70f7;counter-reset: row;input[type="checkbox"] {max-height: 1ch;max-width: 1ch;border: none;}tr {counter-increment: row;th:first-of-type {text-align: right;&::after {box-sizing: border-box;content: counter(row);}}&.selected>th:first-of-type::after {content: counter(row);width: calc(100%);height: 100%;padding: .5em 1ch;border-left: 1ch solid var(--fg);position: absolute;left: 0;top: 0;}th:first-of-type {cursor: context-menu;}}}}}}#db_thead tr:first-of-type td:hover::before,[title]::before,[data-t]::before{position: fixed;bottom: 0px;font-weight: normal;left: 1ch;display: flex;width: 100dvw;height: 2lh;background: var(--bg);color: var(--fg);text-align: left;text-transform:none;align-items: center;justify-content: left;z-index: 9999;}#db_thead tr:first-of-type td:hover::before{content: attr(data-note);}[data-t]:hover::before{content: attr(data-t);}[title]:hover::before{content: attr(title);}#filter_row td[title]{background-color: var(--fg);color: var(--bg);}#filter_row td[title]::after{position: absolute;content: attr(title);white-space: nowrap;max-width: calc(100% - 2ch);left: 1ch;overflow: hidden;text-overflow: ellipsis;}.x,.y {display: flex;gap: 1ch;}x{align-content: center;}.y{flex-direction: column;}#compact_mode:checked ~ * {label[for="compact_mode"]{box-shadow: var(--bs2);}thead {top:1lh;}caption {padding: 0em 1ch;}#db_table tr {th, td {padding: 0em 1ch;height: 1lh;}&.selected>th:first-of-type::after {padding-top: 0;}}}body:has(:popover-open) {#hide_popover {display: block;}}::backdrop {opacity: 0;}#hide_popover{z-index: 99;display: none;background: var(--dark);opacity: 0;width: 100dvw;content: "";height: 100dvh;position: fixed;top: 0;left: 0;}.hide {display: none !important;}#prompt_po {padding: 0;p{padding: .5em 1ch;border-bottom: 1px dashed var(--fg);}input {box-shadow: none;border-bottom: var(--brd);width: 100%;}.x {gap: 0;button {width: 16ch;outline: var(--brd);box-shadow: none;&:hover{font-weight: bold;}text-align: center;}padding: 0lh 0ch;}}#main_menu_po {padding: 0;overflow: hidden;#menu_items_searcher {width: 100%;display: block;padding: 1ch;box-shadow: none;border-bottom: var(--brd);}footer {border-top: var(--brd);min-height: 2lh;display: flex;align-items: center;padding: 0 1ch;text-align: center;}#menu_items {max-height: 50dvh;overflow-y: auto;&::-webkit-scrollbar {width: 2ch;height: 1ch;cursor: pointer;}&::-webkit-scrollbar-thumb {background: var(--bg);border-radius: 0;box-shadow: inset 0 0 0 1px var(--fg);border: none;border-right: 1ch solid var(--bg);}gap: 0;div {display: flex;align-items: center;min-height: 2lh;padding: 0 1ch;border: 1px dotted transparent;border-left: none;border-right: none;&:hover {border-color: var(--fg);}input {display: none;padding: 0;margin: 0;}&:has(input:checked) {font-weight: bold;}button {all: unset;cursor: default;padding: 0;height: auto;border: none;&:hover,&:focus {box-shadow: none;outline-color: transparent;}&:active {background-color: var(--bg);color: var(--fg);}}}}}#file_load_stored {box-shadow: inset 0 0 0 2px var(--fg);&:focus,&:hover {outline: none;background: var(--fg);color: var(--bg);}}</style><style id="column_styles"></style><!-- STOW. By + copyright 2025 Greg Abbott--><title>Stow</title></head><body class="grid"><input type="checkbox" id="compact_mode" hidden=""><div popover="" id="po_license"><p>Name: <span data-t="To carefully and neatly arrange and pack items in a compact mass, and store them in their proper place">Stow</span><br>
Version: 2025_0514<br>
View: <a href="log.html">Change Log</a><br>
By: <a href="https://gregabbott.pages.dev/">Greg Abbott</a></p><hr><p>LICENSE<br>
© 2025 Greg Abbott. All rights reserved.</p><p>NO WARRANTY<br>
THE SOFTWARE IS PROVIDED "AS IS",
WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,
INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE
AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE
FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
</p></div><noscript><div class="full_viewport_notice"><p>This tool requires JavaScript<br><a href="https://gregabbott.pages.dev/">View other tools</a></p></div></noscript><div id="unsupported_browser" class="full_viewport_notice hide"><div><p>Your browser doesn't support the File Access API.<br>
This tool uses it to edit local files.</p><p><a href="https://gregabbott.pages.dev/">View other tools</a></p></div></div><div id="main_menu_po" popover=""><input type="search" id="menu_items_searcher"><div id="menu_items"><div id="new_db"><input type="radio" name="mi"><button>New DB</button></div><div id="file_select"><input type="radio" name="mi"><button>Open File</button></div><div id="file_close"><input type="radio" name="mi"><button>Close File</button></div><div id="file_forget"><input type="radio" name="mi"><button>Forget File</button></div><div id="file_save"><input type="radio" name="mi"><button>Save File</button></div><div id="file_save_as"><input type="radio" name="mi"><button>Save As File</button></div><div id="show_po_license"><input type="radio" name="mi"><button>Read License</button></div><div id="copy_db_as_json"><input type="radio" name="mi"><button>Copy DB as JSON</button></div><div id="records_deselect_all"><input type="radio" name="mi"><button>Deselect all records</button></div></div><footer><div id="file_status"></div></footer></div><div id="filter_popover" class="faux_po_holder hide"><div id="filter_popover_hide" class="faux_po_backdrop"></div><div class="faux_po_content" data-t="Optionally use JS `/RegularExpressions/gi` to search (e.g. `/[a-z]\d{4}$/i`)"><datalist id="filter_tokens"><option value="&quot;Is Blank&quot;"></option><option value="&quot;Not Blank&quot;"></option></datalist><div id="filter_switch" data-t="Click to toggle this filter on or off">Flip</div><input id="filter_query" list="filter_tokens" type="search"></div></div><div id="column_type_po" class="faux_po_holder hide"><div id="column_type_po_hide" class="faux_po_backdrop"></div><div class="faux_po_content"><p><span id="column_type_current_column_name"></span> data type:</p><select id="column_type_picker"><option data-t="Convert new input to the most likely type (Number, Boolean, Null, String)">any</option><option data-t="Keep new inputs as strings">string</option><option data-t="Convert new input to a number where possible (e.g. &quot;8&quot; -&gt; 8)">number</option><option data-t="Accept [true, false, null]">boolean</option></select></div></div><dialog id="file_dialog"><p id="file_dialog_message"></p><menu><button id="file_dialog_done_button">done</button></menu></dialog><div id="row_actions_po" class="faux_po_holder hide"><div id="row_actions_po_hide" class="faux_po_backdrop"></div><div class="faux_po_content"><div><button id="record_make_above">Make Above</button></div><div><button id="record_make_below">Make Below</button></div><div><button id="record_delete_all_ticked">Zap ticked rows</button></div><div><button id="record_delete_clicked">Zap row</button></div><div><button id="record_clone">Clone</button></div><div data-t="Copy row as JSON"><button id="record_copy_as_js_ob">Copy JSON</button></div></div></div><div id="column_actions_po" class="faux_po_holder hide"><div id="column_actions_po_hide" class="faux_po_backdrop"></div><div class="faux_po_content"><div><button id="column_rename" data-t="Rename this column">Name</button></div><div><button id="column_tweak_note">Note</button></div><div><button id="column_tweak_type">Type</button></div><div><button id="column_delete">Zap</button></div><div><button id="column_sort_a_z">Sort A-Z</button></div><div><button id="column_sort_z_a">Sort Z-A</button></div><div><button id="column_move_left">Move Left</button></div><div><button id="column_move_right">Move Right</button></div><div><button id="column_add_before">Add Left</button></div><div><button id="column_add_after">Add Right</button></div></div></div><div id="prompt_po" class="faux_po_holder hide"><div id="prompt_po_hide" class="faux_po_backdrop"></div><div class="faux_po_content"><p id="prompt_message"></p><input type="search" id="prompt_input" size="48"><div class="x"><button id="insert_date" data-t="Insert current date time stamp yyyy_MMdd_hhmm">Stamp</button><button id="prompt_button_yes" data-t="Apply">Keep</button><button id="prompt_button_no" data-t="Cancel">Shut</button></div></div></div><nav><button id="show_main_menu_po">Menu</button><div><label class="button" for="compact_mode" data-t="Toggle the table's vertical cell padding">Cram</label></div><div id="scroll_to_top" class="button hide" data-t="Scroll to top">Rise</div><button id="file_load_stored" data-t="Reopen remembered file from previous session">Reopen</button><div class="grow"></div><div id="facts"><span data-t="Current Saved Status" id="current_saved_status">Unsaved</span> | <span data-t="Records shown that match active filters">Hits <span id="record_facts_visible">N</span></span> | <span data-t="Records / rows in database">Rows <span id="record_facts_total">N</span></span></div><div id="notice" class="hide">Notice</div></nav><main><g-db><div id="table_holder"><table id="db_table"><caption id="db_name"></caption><thead id="db_thead"></thead><tbody id="db_tbody"></tbody></table></div></g-db></main><dialog id="confirm_dialog"><p id="confirm_message"></p><div id="confirm_buttons"><button id="confirm_button_no">No</button><button id="confirm_button_yes" autofocus="">Yes</button></div></dialog><div id="hide_popover"></div><script>/* 
j.js
 */
const g0={};(()=>{const e=[...document.querySelectorAll('[id]:not([id=""])')].reduce(((e,t)=>(e[t.id.trim()]=t,e)),{});function t(){g0.db={},g0.record_els_matching_search_filters=[],g0.menu_items_matching_search=[],g0.selected_menu_item=null,g0.column_active_index=null,g0.row_to_act_on=null,e.filter_row=null,g0.records_selected=new Set,g0.selected_cells=new Set,g0.file_is_loaded=!1,g0.has_unsaved_changes=!1,g0.last_saved_content="",g0.confirm_yes_fn=null,g0.confirm_no_fn=null,g0.prompt_yes_fn=null,g0.prompt_no_fn=null,g0.prompt_pending=!1}function n(e){return Array.from({length:e},(()=>""))}function o({clicked:e,str:t,pass_fn:n,fail_fn:o}){navigator.clipboard.writeText(t).then((()=>{n&&n()})).catch((e=>{o&&o()}))}function l(e){let t=new Set;e.forEach((e=>{Object.keys(e).forEach((e=>t.add(e)))}));let n={};return t.forEach((t=>{let o=[];e.forEach((e=>{o.push(void 0!==e[t]?e[t]:null)})),n[t]=o})),n}function r(){g0.has_unsaved_changes=!0,e.current_saved_status.textContent="Unsaved",g0.allow_auto_save=!0}function i(){g0.has_unsaved_changes=!1,e.current_saved_status.textContent="Saved"}t();function a(e,t){let n=document.createElement(e);return t?t.appendChild(n):n}function c(e,t,n){return n?(n.removeEventListener(e,t),n):n=>c(e,t,n)}function s(e,t,n){return n?(n.addEventListener(e,t),n):n=>s(e,t,n)}function d(e="any",t){if("string"===e)return t;let n=(e=>{try{let t=JSON.parse(e);return null===t||!0===t||!1===t||"number"==typeof t?t:e}catch(t){return e}})(t);return"any"===e?n:0===t.trim().length||null===n?null:typeof n!==e?(Se(`Input "${t}" won't convert to column type '${e}'.`),t):n}function u(e=new Date){const t=["FullYear","Month","Date","Hours","Minutes","Seconds","Milliseconds"],n=["Y","M","d","h","m","s","u"].reduce(((n,o,l)=>{return n[o]=(e[r="get"+t[l]]()+("getMonth"===r)+"").padStart("getMilliseconds"===r?3:2,"0"),n;var r}),{});return n.c=n.Y.substring(0,2),n.y=n.Y.substring(2),n}function _(e=new Date){let t=u(e);return"Y_Md_hm".split("").map((e=>t[e]||e)).join("")}function f(){t(),e.db_name.innerHTML="",e.db_thead.innerHTML="",e.db_tbody.innerHTML=""}function m(){let t={},n={};g0.record_els_matching_search_filters.length=0;let o=[...e.filter_row.querySelectorAll("td")].reduce(((e,o,l)=>{let r=o.column;if(!r.sift||null==r.find||0===r.find.length)return e;if('"Is Blank"'===r.find)return e.set(l,t),e;if('"Not Blank"'===r.find)return e.set(l,n),e;let i=function(e){if(!function(e){return e.length>1&&e.startsWith("/")&&/\/(gi|i|g|ig)?$/.test(e)}(e))return!1;let{exp:t,flags:n=""}=e.match(/\/(?<exp>.*)\/(?<flags>gi|i|g|ig)?$/)?.groups;try{return RegExp(t,n)}catch(e){return!1}}(r.find);if(!1!==i)return e.set(l,i),e;let a=r.find.toLowerCase();return e.set(l,a.split(" ")),e}),new Map);if(0===o.size)return e.db_tbody.querySelectorAll("tr").forEach(re),void(e.record_facts_visible.textContent=e.db_tbody.querySelectorAll("tr").length);e.db_tbody.querySelectorAll("tr").forEach((e=>{let l=!0,r=-1;for(const i of e.querySelectorAll("td")){if(r++,!o.has(r))continue;let e=o.get(r);if(e instanceof RegExp){if(!e.test(i.textContent)){l=!1;break}}else if(e===t){if(i.textContent.trim().length>0){l=!1;break}}else if(e===n){if(0===i.textContent.trim().length){l=!1;break}}else if(1===e.length){if(0==i.textContent.toLowerCase().includes(e[0])){l=!1;break}}else{let t=i.textContent.toLowerCase().split(" ");if(!1===e.every((e=>t.some((t=>t.startsWith(e)))))){l=!1;break}}}l?(g0.record_els_matching_search_filters.push(e),re(e)):(le(e),e.record.is_selected&&fe(e.record))})),de()}function p(t=""){let n={meta:g0.db.meta,form:[],list:[]};return n.meta.last=_(),e.column_names.querySelectorAll("td").forEach((e=>{n.form.push(e.column)})),n.form=l(n.form),e.db_tbody.querySelectorAll("tr").forEach((e=>{let t=[];e.querySelectorAll("td").forEach((e=>{t.push(e.value)})),n.list.push(t)})),JSON.stringify(n,null,t)}function g(e){return e.name??="",e.note??="",e.type=function(e){let t="boolean",n="number",o="any",l="string",r=typeof e===l,i=(e,t)=>typeof e===l&&typeof t===l&&0!==e.length&&0!==t.length&&e.startsWith(t);return r&&(e=e.toLowerCase()),"*"===e||"a"===e||e===o||null===e?o:typeof e===t||"?"===e||"true"===e||"false"===e||i(t,e)?t:typeof e===n||i(n,e)?n:r?l:o}(e.type),void 0===e.sift&&(e.sift=1),1==e.sift&&(e.sift=1),0==e.sift&&(e.sift=0),e.find??="",e}function h(e){var t;e.form&&(null!==(t=e.form)&&"object"==typeof t&&!Array.isArray(t))&&(e.form=function(e){const t=Object.keys(e),n=Math.max(...Object.values(e).map((e=>e.length)));return Array.from({length:n},((n,o)=>t.reduce(((t,n)=>(t[n]=e[n][o]||null,t)),{})))}(e.form));let o=e.list?.[0]?.length;if(0===o&&e.form&&(o=e.form.length||0),o<1){let e="Input doesn't have expected data.\ne.g. {\"form\":{name:[c1v,c2v],…},\"list\":[['a1','b1,],…]}";return Se(e),void console.error(e)}if(null==e.form&&(e.form=[]),0==e.form.length||e.form.length<o)for(;e.form.length<o;)e.form.push({name:"",note:"",type:"any",sift:!1,find:""});var l;return null!=e.list&&0!==e.list.length||(e.list=[n(o)]),g0.db.meta=(l=e.meta)?(void 0===l.name&&(l.name="Untitled DB"),void 0===l.made&&(l.made=_()),void 0===l.note&&(l.note=""),l):{name:"Untitled DB",note:"",made:_()},g0.db.form=e.form.map(g),g0.db.list=e.list.map((e=>({data:e}))),g0.db}function y(e){if(!e||0===e.size)return null;for(const t of e)return t}function w(e,t){s("contextmenu",(function(t){t.preventDefault(),s("mouseup",(function t(n){n.preventDefault(),e(n),c("mouseup",t,document)}),document)}),t)}function b(t){const n=t.target.closest("tr");n&&(g0.row_to_act_on=n,function(t){g0.records_selected.size>1&&g0.records_selected.has(g0.row_to_act_on.record)?(re(e.record_delete_all_ticked),le(e.record_delete_clicked)):(le(e.record_delete_all_ticked),re(e.record_delete_clicked));re(e.row_actions_po),D({event:t,element:e.row_actions_po.querySelector(".faux_po_content")})}(t))}function v(){g0.selected_cells.size>0&&g0.selected_cells.forEach((e=>{e.classList.remove("selected")})),g0.selected_cells.clear()}function x(e){g0.selected_cells.add(e),e.classList.add("selected")}function S(e){let t=a("tr");t.className="record";a("th",t);return e.data.forEach((e=>{let n=a("td",t);n.textContent=e,n.value=e})),t.record=e,Object.defineProperty(e,"is_selected",{get:()=>t.classList.contains("selected"),enumerable:!0,configurable:!0}),e.dom={row:t},e}function C(t,n=!1){let o=g0.row_to_act_on;return o||(o=y(g0.selected_cells)?.parentNode),o?(e.db_tbody.insertBefore(t.dom.row,o),!1===n&&e.db_tbody.insertBefore(o,t.dom.row)):e.db_tbody.insertBefore(t.dom.row,e.db_tbody.firstChild),t}function k({above:t}){let n=S(function(){let t={data:[]};return e.filter_row.querySelectorAll("td").forEach((e=>{let n=e.column.find.trim();n.length>2&&'"'==n[0]&&n.endsWith('"')&&(n=""),t.data.push(n)})),t}());return C(n,t),r(),m(),me(n)?Se("Clear the active search to see the new record"):_e(),n}function A(){let t=g0.row_to_act_on;t||console.log("record_copy_as_js_ob no row to act on");let n=[];t.querySelectorAll("td").forEach((e=>{n.push(e.value)}));let l=[];e.column_names.querySelectorAll("td").forEach(((e,t)=>{let o=n[t];"string"==typeof o&&(o=`"${o}"`),l.push(`"${e.column.name}":${o}`)})),o({str:`{\n${l.join(",\n")}\n}`,pass_fn:()=>Se("Copied row as JSON"),fail_fn:()=>Se("Failed to row as JSON")})}function E(){let e=g0.row_to_act_on;if(!e)return void Se("Select a record to clone then try again");let t={data:[]};e.querySelectorAll("td").forEach((e=>{t.data.push(e.value)})),t=S(t),C(t),_e(),r()}s("click",(function(){o({str:p(" "),pass_fn:()=>Se("Copied DB as JSON"),fail_fn:()=>Se("Failed to copy DB as JSON")})}),e.copy_db_as_json),s("click",(async()=>{let e=!0;if(g0.file_is_loaded){if(!await se.file_close())return;e=!1}be.prompt({message:"Wanted column names (Comma Separate)",initial:"A,B,C",yes_fn:t=>{e&&f();let o=t.split(",");$(h({meta:{name:"Untitled Doc",made:_(),note:""},form:{name:o},list:[n(o.length)]}))},no_fn:()=>{Se('Cancelled "Make New DB"')},y_text:"Make",n_text:"Stop"})}),e.new_db),w(b,e.db_tbody),s("click",(function(t){const n=t.target.closest("tr");if(!n)return;let o=n.record;t.target===n.firstChild?b(t):g0.records_selected.has(o)&&1===g0.records_selected.size&&1===g0.selected_cells.size&&t.target===y(g0.selected_cells)?(!function(t){D({event:t,element:e.prompt_po.querySelector(".faux_po_content")})}(t),ee()):(_e(),v(),"TD"==t.target.tagName&&x(t.target))}),e.db_tbody);let q={};function T(){return e.column_names.querySelectorAll("td")[g0.column_active_index].column}function L(e){let t=e.closest("tr").querySelectorAll("td"),n=-1;for(let o=0;o<t.length;o++)if(t[o]===e){n=o;break}return n}function D({event:e,element:t}){const{clientX:n,clientY:o}=e;let{offsetWidth:l,offsetHeight:r}=t;const i=window.innerWidth,a=window.innerHeight;let c=n+l+3>i,s=o+r+3>a,d=c?Math.max(n-l-3,0):n+3,u=s?Math.max(a-r-3,0):o+3,_=N(d,Ce,c),f=N(u,ke,s);t.style.left=_+"px",t.style.top=f+"px"}function N(e,t,n){return Math[n?"floor":"ceil"](e/t)*t}function z(t){g0.column_active_index=L(t.target);t.target;let n=e.column_actions_po;re(n),D({event:t,element:n.querySelector(".faux_po_content")})}function M(){let t=[];e.column_names.querySelectorAll("td").forEach(((e,n)=>{const o=n+1;"number"===e.column.type&&t.push(`\n        #db_table td:nth-of-type(${o}) {\n          text-align: right;\n        }\n      `)})),e.column_styles.innerHTML=t.join("\n")}q.move=(t,n)=>{let o="left"===t,l=!o;if(o&&0==g0.column_active_index)Se("Already left-most");else if(l&&g0.column_active_index===e.column_names.querySelectorAll("td").length-1)Se("already right-most");else{let i=g0.column_active_index+l;function r(e){let t=e.querySelectorAll("td")[i];e.insertBefore(t,t.previousElementSibling)}e.db_thead.querySelectorAll("tr").forEach(r),e.db_tbody.querySelectorAll("tr").forEach(r)}n&&n()},q.tweak_type=()=>{let t=T(),n=t.name.trim();e.column_type_current_column_name.textContent=n.length<1?'"Untitled Column"':`"${n}"`,e.column_type_picker.value=t.type,re(e.column_type_po)},s("input",(()=>{T().type=e.column_type_picker.value,M()}),e.column_type_picker),s("click",(t=>{le(e.column_type_po)}),e.column_type_po_hide),s("click",(t=>{le(e.prompt_po)}),e.prompt_po_hide),q.tweak_note=()=>{let t=e.column_names.querySelectorAll("td")[g0.column_active_index],n=t.column,o=prompt(`Tweak Note "${n.note}"`,n.note);null===o?Se('User cancelled "Rename Column"'):(t.dataset.note=o,n.note=o)},q.rename=()=>{let t=e.column_names.querySelectorAll("td")[g0.column_active_index],n=t.textContent;be.prompt({message:`Rename Column "${n}"`,initial:n,yes_fn:e=>{t.column.name=e,t.textContent=e},no_fn:()=>{Se('User cancelled "Rename Column"')}})},q.sort=t=>{confirm("Sort Column\n(No 'undo' available afterwards)")&&function(e,t,n){const o=new Intl.Collator("en",{sensitivity:"base"}),l=function(e){return e.querySelectorAll("td")[t].textContent.trim()},r=Array.from(e.rows).slice().sort((function(e,t){var r=o.compare(l(e),l(t));return"a-z"===n?r:-r})),i=document.createDocumentFragment();r.forEach((function(e){i.appendChild(e)})),e.appendChild(i)}(e.db_tbody,g0.column_active_index,t)},q.delete=()=>{e.db_thead.querySelectorAll("tr:first-child td").length<2?Se("Table needs at least 1 Data Column"):be.confirm({text:"Delete column and all data in it (permanent)",yes_fn:()=>{let t=null;function n(e){let n=e.querySelectorAll("td")[g0.column_active_index];null===t&&(t=n.column),n.remove()}e.db_thead.querySelectorAll("tr").forEach(n),e.db_tbody.querySelectorAll("tr").forEach(n),m(),function({element:e,array:t}){const n=t.indexOf(e);-1!==n&&t.splice(n,1)}({element:t,array:g0.db.form}),Se('"Deleted Column"')},no_fn:()=>Se('Cancelled "Delete Column"')})},q.add=t=>{let n="after"===t,o="before"===t,l=null,r=null;g0.column_active_index;let i={name:"",note:"",type:"any",sift:!1,find:""};function c(e){return t=>{var c;r=e?t.make_new_cell(i):a("td"),l=t.querySelectorAll("td")[g0.column_active_index],o?t.insertBefore(r,l):n&&(c=r,l.insertAdjacentElement("afterend",c))}}g0.db.form.push(i),e.db_thead.querySelectorAll("tr").forEach(c(!0)),e.db_tbody.querySelectorAll("tr").forEach(c(!1))},s("click",(function(t){if(le(e.column_actions_po),"BUTTON"!==t.target.tagName)return;let n=q,o={column_add_before:()=>n.add("before"),column_add_after:()=>n.add("after"),column_move_left:()=>n.move("left"),column_move_right:()=>n.move("right"),column_delete:n.delete,column_sort_a_z:()=>n.sort("a-z"),column_sort_z_a:()=>n.sort("z-a"),column_rename:n.rename,column_tweak_note:n.tweak_note,column_tweak_type:n.tweak_type}[t.target.id];o&&(o(),Ae(),M())}),e.column_actions_po),w((e=>{e.preventDefault(),"TD"===e.target.tagName&&z(e)}),e.db_thead),s("click",(function(t){if(le(e.row_actions_po),"BUTTON"!==t.target.tagName)return;let n={record_make_above:()=>k({above:!0}),record_make_below:()=>k({above:!1}),record_delete_all_ticked:oe,record_delete_clicked:ne,record_clone:E,record_copy_as_js_ob:A}[t.target.id];n&&(n(),de())}),e.row_actions_po);const O={};function B(){let t=g0.current_filter_cell;t.column.find=e.filter_query.value.trim(),R(t),_e(),m()}function P(){g0.current_filter_cell.classList.remove("selected"),g0.current_filter_cell=null,le(e.filter_popover),he()}function R(e){let t,n=e.column;t=n.sift&&n.find.length>0?n.find:"",t?e.title=t:e.removeAttribute("title")}function F(t){let n=t.target;g0.current_filter_cell=n,g0.current_filter_cell.classList.add("selected"),re(e.filter_popover),D({event:t,element:e.filter_popover.querySelector(".faux_po_content")}),e.filter_query.focus(),e.filter_switch.textContent=n.column.sift?"Doze":"Wake",e.filter_query.value=n.column.find}function W(){if(1!==g0.selected_cells?.size)return void Se('If you select a cell, "F" key opens the column filter');let t=y(g0.selected_cells),n=[...t.parentNode.querySelectorAll("td")].indexOf(t);e.filter_row.querySelectorAll("td")[n].click()}function $(t){e.db_thead.innerHTML="",e.db_tbody.innerHTML="",function(t){e.db_name.textContent=t.meta.name,e.db_name.meta=t.meta,e.db_name.onclick=()=>{be.prompt({message:"Rename DB",initial:e.db_name.meta.name,yes_fn:t=>{t=t.trim(),e.db_name.textContent=t,e.db_name.meta.name=t},no_fn:()=>{Se("Cancelled rename DB")}})}}(t),O.name(t),M(),O.find(t),function(t){const n=document.createDocumentFragment();t.forEach((e=>n.appendChild(e.dom.row))),e.db_tbody.innerHTML="",e.db_tbody.appendChild(n)}(t.list.map((e=>S(e)))),he(),m(),de(),Ae()}function j(e){return Array.isArray(e)}function H(e){return["INPUT","BUTTON","SELECT","TEXTAREA"].includes(e.tagName)}function U(e){function t(e){H(e)?e.disabled=!0:e.classList.add("disabled")}j(e)?e.forEach(t):t(e)}function I(e){function t(e){H(e)?e.disabled=!1:e.classList.remove("disabled")}j(e)?e.forEach(t):t(e)}function J(){0==e.menu_items_searcher.value.trim().length?(e.menu_items_searcher.blur(),e.main_menu_po.hidePopover()):(e.menu_items_searcher.value="",e.menu_items_searcher.focus(),X())}function Y(){e.main_menu_po.showPopover(),e.menu_items_searcher.focus()}O.name=t=>{let n=a("tr",e.db_thead);e.column_names=n;a("th",n);n.make_new_cell=e=>{let t=a("td",n);return t.dataset.note=e.note,t.column=e,t.textContent=e.name,t.onclick=z,t},t.form.forEach(n.make_new_cell)},s("input",B,e.filter_query),s("click",(()=>{let t=g0.current_filter_cell,n=!t.column.sift;t.column.sift=n?1:0,e.filter_switch.textContent=n?"Doze":"Wake",B()}),e.filter_switch),s("click",(()=>{P()}),e.filter_popover_hide),O.find=t=>{let n=a("tr",e.db_thead);n.id="filter_row",e.filter_row=n;let o=a("th",n);o.textContent="Find",o.dataset.t="Show rows whose columns contain these values",n.make_new_cell=e=>{let t=a("td",n);return t.column=e,R(t),t.onclick=F,t},t.form.forEach(n.make_new_cell)},s("input",X,e.menu_items_searcher),s("click",(t=>{e.main_menu_po.hidePopover()}),e.menu_items),s("click",(function(){e.po_license.showPopover()}),e.show_po_license),s("click",Y,e.show_main_menu_po),s("focus",(()=>{X()}),e.menu_items_searcher);let K=[...e.menu_items.getElementsByTagName("DIV")].map((e=>{let t={dom:e,dom_text:e.textContent.toLowerCase().trim()};return t.words=t.dom_text.split(/\s+/),t}));function X(){let t=e.menu_items_searcher.value.toLowerCase().trim();function n(e){g0.menu_items_matching_search.push(e),re(e.dom)}if(g0.menu_items_matching_search.length=0,g0.selected_menu_item=null,0==t.length)K.forEach((e=>{!e.dom.classList.contains("disabled")?n(e):le(e.dom)}));else{let e=t.split(/\s+/);e.length;K.forEach((t=>{let o=!t.dom.classList.contains("disabled"),l=(r=t.words,e.every((e=>r.some((t=>t.startsWith(e))))));var r;o&&l?n(t):le(t.dom)}))}V()}function G(e){e.dom.querySelector("input").checked=!0,g0.selected_menu_item=e}function V(){let e=g0.menu_items_matching_search.length>0?g0.menu_items_matching_search:K;if(0===e.length)return;let t=e.indexOf(g0.selected_menu_item),n=e.length-1==t?0:t+1;t!==n&&(G(e[n]),ue(g0.selected_menu_item.dom))}function Q(){let e=g0.menu_items_matching_search.length>0?g0.menu_items_matching_search:K;if(0===e.length)return;let t=e.indexOf(g0.selected_menu_item),n=t<1?e.length-1:t-1;t!==n&&(G(e[n]),ue(g0.selected_menu_item.dom),ue(g0.selected_menu_item.dom))}function Z(e){e.preventDefault(),g0.selected_menu_item&&(e.target.blur(),e.target.value="",g0.selected_menu_item.dom.click())}function ee(){if(1!==g0.selected_cells?.size)return void Se('If you select a cell, "Enter" key will start edit mode');let t=y(g0.selected_cells);be.prompt({initial:t.value??"",yes_fn:n=>{let o=t.parentNode,l=function(t,n){let o=[...n.querySelectorAll("td")].indexOf(t);return e.column_names.querySelectorAll("td")[o].column}(t,o);n=n.trim(),t.textContent=n,t.value=d(l.type,n),m(),r()},no_fn:()=>{Se("Cancelled editing cell")}})}function te(e){e.dom.row.remove(),g0.records_selected.delete(e)}function ne(){te(g0.row_to_act_on.record)}function oe(){let e=g0.records_selected.size;be.confirm({text:`Delete ${e} ticked rows?`,yes_fn:()=>{g0.records_selected.forEach(te),m(),r(),Se(`Deleted ${e} rows`)},no_fn:()=>Se('Cancelled "delete ticked rows"')})}function le(e){e.classList.add("hide")}function re(e){e.classList.remove("hide")}const ie=(()=>{const e="handles",t="2025_0506";let n=null;const o={open_db:()=>new Promise(((t,o)=>{const l=indexedDB.open("fileHandleDB",1);l.onupgradeneeded=t=>{const n=t.target.result;n.objectStoreNames.contains(e)||n.createObjectStore(e,{keyPath:"id"})},l.onsuccess=e=>{n=e.target.result,t()},l.onerror=e=>o(e.target.error)}))},l=(t,o)=>new Promise(((l,r)=>{const i=o(n.transaction(e,t).objectStore(e));i.onsuccess=()=>l(i.result),i.onerror=e=>r(e.target.error)}));return o.save_handle=(e,n)=>l("readwrite",(o=>o.put({id:t,handle:e,name:n}))),o.load_handle=()=>l("readonly",(e=>e.get(t))),o.delete_handle=()=>l("readwrite",(e=>e.delete(t))),o})(),ae=async(e,t="readwrite")=>{const n={mode:t};return"granted"===await e.queryPermission(n)||"granted"===await e.requestPermission(n)},ce=t=>{e.file_status.textContent=t};s("click",(()=>{e.file_dialog.close()}),e.file_dialog_done_button),window.addEventListener("beforeunload",(e=>{g0.has_unsaved_changes&&e.preventDefault()}));const se={};se.update_file_buttons=async()=>{const t=await ie.load_handle();[e.file_forget,e.file_save,e.file_close].forEach(t?I:U),t&&!g0.file_is_loaded?(re(e.file_load_stored),e.file_load_stored.textContent=`Load "${t.name}"`,e.file_load_stored.focus(),U(e.file_close)):(le(e.file_load_stored),I(e.file_close))},se.load_editor=async(t,n=null)=>{if(await se.file_close(),f(),ce("Reading file..."),!await ae(t,"read"))throw Error("Read permission denied");const o=await t.getFile();let l=o.type.startsWith("application/json"),r=o.type.startsWith("application/gzip")||o.type.startsWith("application/x-gzip");if(!(l||r))return a="Not JSON / Gzipped JSON file",e.file_dialog_message.textContent=a,void e.file_dialog.showModal();var a;let c;if(l&&(c=await o.text()),r){const e=await o.arrayBuffer();c=await async function(e){let t=e;e instanceof ArrayBuffer&&(t=new Blob([e]));const n=t.stream().pipeThrough(new DecompressionStream("gzip")),o=await new Response(n).blob();return await function(e){return new Promise(((t,n)=>{const o=new FileReader;o.onload=()=>t(o.result),o.onerror=n,o.readAsText(e)}))}(o)}(e)}!function(e){if(!e)return console.log("No data stored to restore");$(h(JSON.parse(e)))}(c),i(),g0.file_is_loaded=!0,n&&ce(`Loaded "${n}"`),await se.update_file_buttons()},se.save_content=async(e,t)=>{const n=performance.now();if(!await ae(e))throw Error("Write permission denied");const o=await e.createWritable();let l=p("");if(t.endsWith(".gz")){const e=new TextEncoder,t=new ReadableStream({start(t){t.enqueue(e.encode(l)),t.close()}}).pipeThrough(new CompressionStream("gzip"));await t.pipeTo(o)}else await o.write(l),await o.close();ce("File saved successfully. "+function(e){return"Took "+function(e){const t=Math.floor(e/1e3),n=Math.floor(t/60),o=t%60;if(0===n)return o+"s";return`${n}m ${o}s`}(performance.now()-e)}(n)),g0.file_is_loaded=!0,i()},se.file_save=async()=>{const e=await ie.load_handle();if(!e)return se.file_save_as();await ae(e.handle)||ce("Permission denied."),await se.save_content(e.handle,e.name),await se.update_file_buttons()},se.file_save_as=async()=>{const e=await window.showSaveFilePicker({suggestedName:_()+".gz",types:[{description:"JSON",accept:{"application/json":[".json"]}},{description:"Gzip Compressed File",accept:{"application/gzip":[".gz"],"application/x-gzip":[".gz"]}}]});if(!await ae(e))return ce("Permission denied.");const t=await e.getFile();await ie.save_handle(e,t.name),await se.save_content(e,t.name),await se.update_file_buttons()},se.file_select=async()=>{try{const[e]=await window.showOpenFilePicker();ce("Saving file handle...");const t=(await e.getFile()).name;await ie.save_handle(e,t),await se.load_editor(e,t)}catch(e){"AbortError"===e.name?Se("Cancelled 'open file'"):console.error("An error occurred:",e)}},se.file_load_stored=async()=>{if(!await se.file_close())return;const e=await ie.load_handle().catch((e=>{console.log(e.message),console.log("Possibilities:\n- Tool hasn't setup the indexedDB (idb) yet\n- idb has no file stored to re-open\n- tool tried to open file before user page interaction")}));e&&(await ae(e.handle,"read")||ce("Permission not granted."),await se.load_editor(e.handle,e.name))},se.file_close=async()=>!(g0.has_unsaved_changes&&!confirm("You have unsaved changes. Close anyway?"))&&(f(),ce("File closed. Handle remains."),await se.update_file_buttons(),!0),se.file_forget=async()=>{!await se.file_close()||(await ie.delete_handle(),ce("Handle Forgotten."),await se.update_file_buttons())};function de(){let t=e.db_tbody.querySelectorAll("tr"),n=e.db_tbody.querySelectorAll("tr.hide");e.record_facts_visible.textContent=t.length-n.length,e.record_facts_total.textContent=t.length}function ue(e){const t=e.getBoundingClientRect(),n=e.parentNode,o=n.getBoundingClientRect();let l=t.top<o.top;t.bottom>o.bottom?n.scrollTop+=t.bottom-o.bottom:l&&(n.scrollTop+=t.top-o.top)}function _e(){g0.records_selected.forEach(fe),g0.records_selected.clear()}function fe(e){if(!e)return console.log("pass deselect_row a record");e.dom.row.classList.remove("selected"),g0.records_selected.delete(e)}function me(e){return e.dom.row.classList.contains("hide")}function y(e){return e.values().next().value}s("click",_e,e.records_deselect_all);let pe=()=>!(1!==g0.selected_cells.size)&&y(g0.selected_cells),ge=e=>{let t=pe();if(!t)return void he();let n=function(e,t){if(!(e instanceof HTMLTableCellElement))return console.error("Invalid TD element."),!1;const n=e.parentElement;if(!n||"tr"!==n.nodeName.toLowerCase())return!1;const o=Array.from(n.querySelectorAll("td")),l=o.indexOf(e);if("left"===t)return l>0&&o[l-1];if("right"===t)return l<o.length-1&&o[l+1];const r=n.parentElement;if(!r||"tbody"!==r.nodeName.toLowerCase())return!1;const i=Array.from(r.querySelectorAll("tr:not(.hide)")),a=i.indexOf(n),c=e=>{const t=Array.from(e.querySelectorAll("td"));return t.length>l&&t[l]};return"above"===t?a>0&&c(i[a-1]):"below"===t?a<i.length-1&&c(i[a+1]):(console.error("Invalid direction. Use 'left', 'right', 'above', or 'below'."),!1)}(t,e);if(!n)return!1;v(),x(n)};function he(){let t=function(e){if(!e||"tbody"!==e.nodeName.toLowerCase())return console.error("Provided element is not a valid tbody."),!1;const t=e.querySelector("tr:not(.hide)");return t&&t.querySelector("td")||!1}(e.db_tbody);t&&(v(),x(t))}function ye(e){let t=pe();if(!t)return;let n="left"===e,o="above"===e,l="below"===e;if(n||"right"===e)g0.column_active_index=L(t),q.add(n?"before":"after"),ge(e);else if(o||l){g0.row_to_act_on=t.parentNode,me(k({above:o}))||ge(e)}}function we(e){e.preventDefault();let t=e.target;if(0===t.value.length)return ve();t.value="",t.focus()}s("keydown",(function(t){if(t.ctrlKey||t.shiftKey||t.metaKey)return;let n;if(document.activeElement==e.menu_items_searcher)n={Escape:J,Enter:Z,ArrowDown:V,ArrowUp:Q}[t.key];else if(document.activeElement===e.prompt_input)n={Enter:()=>e.prompt_button_yes.click(),Escape:we}[t.key];else if(null!==g0.current_filter_cell&&void 0!==g0.current_filter_cell)n={Escape:P,Enter:P}[t.key];else{if(null!==document.querySelector("dialog[open]")||null!==document.querySelector(":popover-open"))return;n={"/":Y,f:W,Enter:ee,alt_ArrowUp:()=>ye("above"),alt_ArrowDown:()=>ye("below"),alt_ArrowLeft:()=>ye("left"),alt_ArrowRight:()=>ye("right"),ArrowUp:()=>ge("above"),ArrowDown:()=>ge("below"),ArrowLeft:()=>ge("left"),ArrowRight:()=>ge("right")}[(t.altKey?"alt_":"")+t.key]}n&&(t.preventDefault(),n(t))}),window),s("click",(()=>{let t=_(),n=e.prompt_input,o=n.value.trim();0!=o.length?n.value=o+" "+t:n.value=t}),e.insert_date);const be={};function ve(){g0.prompt_pending=!1,le(e.prompt_po),g0.prompt_no_fn&&(g0.prompt_no_fn(),g0.prompt_no_fn=null),e.prompt_input.value=""}be.prompt=({message:t,initial:n,yes_fn:o=null,no_fn:l=null,y_text:r="Apply",n_text:i="Exit"})=>{g0.prompt_pending=!0,t?(e.prompt_message.textContent=t,re(e.prompt_message)):le(e.prompt_message),g0.prompt_yes_fn=o,g0.prompt_no_fn=l,e.prompt_input.value=n,re(e.prompt_po),e.prompt_input.focus(),e.prompt_button_no.textContent=i,e.prompt_button_yes.textContent=r},s("click",ve,e.prompt_button_no),s("click",(function(){g0.prompt_pending=!1,le(e.prompt_po),g0.prompt_yes_fn&&(g0.prompt_yes_fn(e.prompt_input.value),g0.prompt_yes_fn=null),e.prompt_input.value=""}),e.prompt_button_yes),s("click",(()=>{g0.prompt_pending&&ve()}),e.hide_popover),be.confirm=({text:t="",yes:n="Yes",no:o="No",yes_fn:l,no_fn:r})=>{l||console.warn("Pass confirm a yes_fn"),g0.confirm_yes_fn=l,g0.confirm_no_fn=r,e.confirm_message.textContent=t,e.confirm_button_yes.textContent=n,e.confirm_button_no.textContent=o,e.confirm_dialog.showModal(),e.confirm_button_yes.focus()},s("click",(()=>{e.confirm_dialog.close(),g0.confirm_yes_fn&&(g0.confirm_yes_fn(),g0.confirm_yes_fn=null)}),e.confirm_button_yes),s("click",(()=>{e.confirm_dialog.close(),g0.confirm_no_fn&&(g0.confirm_no_fn(),g0.confirm_no_fn=null)}),e.confirm_button_no);let xe=null;function Se(t){e.notice.textContent=t,re(e.notice),xe=setTimeout((()=>le(e.notice)),3e3)}s("load",(async function(){"showOpenFilePicker"in window&&"showSaveFilePicker"in window?(await(async()=>{await ie.open_db(),await se.update_file_buttons();const t=await ie.load_handle();ce(t?`Stored file reference found: "${t.name}"`:"No stored file reference. Open or Save As to begin."),["file_select","file_load_stored","file_close","file_forget","file_save","file_save_as"].forEach((t=>{e[t].onclick=se[t]}))})(),await se.update_file_buttons(),g0.file_is_loaded||$(h({meta:{name:"Demo",made:_(),note:"An example table showing some shortcuts"},form:l([{name:"Press",note:"Keyboard shortcut",type:"string",find:"",sift:1},{name:"Action",note:"What the shortcut does",type:"string",find:"",sift:1},{name:"Tag",note:"Relates to",type:"string",find:"",sift:1}]),list:[["alt+up","Add row above current selected cell","Row"],["alt+down","Add row below current selected cell","Row"],["alt+left","Add column to left of current selected cell","Column"],["alt+right","Add column to right of current selected cell","Right"],["f","Filter column of current cell","Column"],["/","Open menu and search for option","Tool"],["Enter","Edit","Cell"],["Arrow up","Select cell above","Cell"],["Arrow down","Select cell below","Cell"],["Arrow left","Select cell on the left","Cell"],["Arrow right","Select cell on the right","Cell"],["Hover","Show any tip","Tool"]]})),function(){function e(){g0.allow_auto_save&&(g0.allow_auto_save=!1,g0.file_is_loaded&&g0.page_loaded&&g0.has_unsaved_changes&&(console.log("try save"),se.file_save()))}s("blur",e,window),s("beforeunload",e,window),s("pagehide",e,window),s("visibilitychange",e,document),g0.page_loaded=!0}(),Ae()):re(e.unsupported_browser)}),window);let Ce=function(e){const t=document.createElement("span");e&&(t.style.fontSize=e);t.style.position="fixed",t.style.visibility="hidden",t.style.whiteSpace="nowrap",t.textContent="0",document.body.appendChild(t);const n=t.offsetWidth;return document.body.removeChild(t),n}(),ke=15;function Ae(){!function(e){e.style.width="auto";const t=e.getBoundingClientRect().width,n=e.parentNode.clientWidth,o=Ce;let l=Math.round(t/o)*o;l>n&&(l=Math.floor(n/o)*o),l!==t&&(e.style.width=l+"px")}(e.db_table)}!function(e,t,n){let o;const l=()=>{const o=Math.round(e.scrollTop/t)*t,l=Math.round(e.scrollLeft/n)*n;e.scrollTo({top:o,left:l,behavior:"smooth"})};e.addEventListener("scroll",(()=>{clearTimeout(o),o=setTimeout((()=>{l()}),100)})),e.addEventListener("wheel",(t=>{t.preventDefault();const n=t.deltaY,r=t.deltaX;e.scrollTop+=n,e.scrollLeft+=r,clearTimeout(o),o=setTimeout((()=>{l()}),100)}))}(e.table_holder,ke,Ce),s("click",(()=>{e.table_holder.scrollTop=0}),e.scroll_to_top),s("scroll",(()=>{e.table_holder.scrollTop>0&&e.scroll_to_top.classList.contains("hide")&&re(e.scroll_to_top),0!=e.table_holder.scrollTop||e.scroll_to_top.classList.contains("hide")||le(e.scroll_to_top)}),e.table_holder),window.addEventListener("resize",Ae)})();</script></body></html>